<!DOCTYPE html>
<html
  lang="en-us"
  prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"
>
  <head>
    <meta charset="utf-8" />

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="HandheldFriendly" content="True" />
<meta name="MobileOptimized" content="320" />
<meta name="viewport" content="width=device-width, initial-scale=1" />


<link rel="apple-touch-icon" sizes="180x180" href="https://robinsonraju.info//apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://robinsonraju.info//favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://robinsonraju.info//favicon-16x16.png">
<link rel="manifest" href="https://robinsonraju.info//site.webmanifest">
<link rel="mask-icon" href="https://robinsonraju.info//safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">



<meta name="keywords" content="">

<meta property="og:title" content="A Simple MapReduce Job for Iris Dataset" />
<meta property="og:description" content="This blog is an attempt to walk through the process of using hadoop to analyze a dataset that might look similar to an actual dataset that we might encounter." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://robinsonraju.info/tech-notes/2015-09-30-mapreducejob-iris/" />
<meta property="article:published_time" content="2015-09-30T22:50:11+00:00" />
<meta property="article:modified_time" content="2015-09-30T22:50:11+00:00" /><meta property="og:site_name" content="Rob&#39;s Notes" />

<meta property="og:site_name" content="Robinson Raju" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="A Simple MapReduce Job for Iris Dataset"/>
<meta name="twitter:description" content="This blog is an attempt to walk through the process of using hadoop to analyze a dataset that might look similar to an actual dataset that we might encounter."/>


<meta itemprop="name" content="A Simple MapReduce Job for Iris Dataset">
<meta itemprop="description" content="This blog is an attempt to walk through the process of using hadoop to analyze a dataset that might look similar to an actual dataset that we might encounter.">
<meta itemprop="datePublished" content="2015-09-30T22:50:11&#43;00:00" />
<meta itemprop="dateModified" content="2015-09-30T22:50:11&#43;00:00" />
<meta itemprop="wordCount" content="426">



<meta itemprop="keywords" content="" />


    <title>A Simple MapReduce Job for Iris Dataset || Robinson Raju</title>
    <link rel="canonical" href="https://robinsonraju.info/tech-notes/2015-09-30-mapreducejob-iris/" />

    

    <link rel="stylesheet" href="/css/reboot.css" />
<link rel="stylesheet" href="/css/style.css" />
<link rel="stylesheet" href="/css/syntax.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<link href="https://fonts.googleapis.com/css?family=Lora&display=swap" rel="stylesheet">

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  </head>
  <body
  class=" look-sheet-bkg"
  lang="en-us">
  <div class="nav-bkg">
    <nav class="content-container pagewide-bar-padding">
      <span class="divider">/ </span>
      <a href="https://robinsonraju.info/" >Robinson Raju</a>
      <span class="divider">/ </span>
  <a href="https://robinsonraju.info/tech-notes">Technical Notes</a>
      <ul class="list-unstyled right-links">

          <li>
            <a href="/about">
              <span class="post-title">About</span>
            </a>
          </li>

</ul>

    </nav>
  </div>
  <article
    id="main"
    class="content-container look-sheet article-pad-v "
    itemscope
    itemtype="https://schema.org/Article" >
  <meta itemprop="author" content="Robinson Raju" />
  <meta itemprop="publisher" content="Robinson Raju" />
  <meta itemprop="image" content="" />
  <meta itemprop="headline" content="A Simple MapReduce Job for Iris Dataset" />
  <h1 itemprop="name" id="title">A Simple MapReduce Job for Iris Dataset</h1>

  

    <h4 itemprop="name" id="title">Robinson Raju</h4>

    

    
      <div class="post-tags">
        
          <a href="https://robinsonraju.info/tags/technical-notes/">#Technical Notes</a>&nbsp;
        
          <a href="https://robinsonraju.info/tags/blog/">#Blog</a>&nbsp;
        
      </div>
    

    
      <div class="post-date">
        
          <span itemprop="datePublished">September 30, 2015</span>
          <meta itemprop="dateModified" content="September 30, 2015"/>
        
      | 426 words
      | 2-minute read
      </div>
    

    

  


  <div itemprop="articleBody" id="content" class="article-body margin-top-2em">
    <p>This blog is an attempt to walk through the process of using hadoop to analyze a dataset that might look similar to an actual dataset that we might encounter.</p>
<p>The objective is to read data from Iris dataset - <a href="https://archive.ics.uci.edu/ml/datasets/Iris">https://archive.ics.uci.edu/ml/datasets/Iris</a> and calculate the mean sepal length of each class of the flower.</p>
<p>The data is here -&gt; <a href="https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</a>.</p>
<p>Sample record : <code>5.1,3.5,1.4,0.2,Iris-setosa</code></p>
<p>Attribute Information:</p>
<ol>
<li>sepal length in cm</li>
<li>sepal width in cm</li>
<li>petal length in cm</li>
<li>petal width in cm</li>
<li>class: a) Iris Setosa, b) Iris Versicolour, c) Iris Virginica</li>
</ol>
<p>In the last blog on wordcount, I used an eclipse project that was bundled automatically with the Cloudera VM and just modified the StubMapper, StubReducer and Driver to plugin the code for wordcount. In this, I thought I&rsquo;ll create one from scratch and see how it works.</p>
<h2 id="step-1--create-a-java-project">Step #1 : Create a Java project</h2>
<p>Create a Java project using Eclipse.
Add Mapper, Reducer and Driver stubs from the other project. You&rsquo;ll immediately notice that there are many compilation errors.</p>
<h2 id="step-2-configure-build-path">Step 2: Configure Build Path</h2>
<p>Add the following libraries from <code>/usr/lib/hadoop/client</code> and <code>/cloudera/lib</code></p>
<p><code>Properties &gt; Java Build Path &gt; Add External Jars</code></p>
<img src="/img/hadoop/add_lib2.png" width="420"/>
<img src="/img/hadoop/add_lib1.png" width="420"/>
<p>Also add <code>&lt;project&gt;/conf</code> as the class folder.</p>
<img src="/img/hadoop/class_folder.png" width="420"/>
<p>Now the compilation issues would be resolved.</p>
<h2 id="step-3-add-code-for-mapper-and-reducer">Step 3: Add code for Mapper and Reducer</h2>
<p>The objective is to read the records from the data and compute the mean sepal length of each class of the Iris flower.
map() function in the Mapper gets each row and splits the columns to extract out the key (flower class) and the value (sepal length).
The reduce() function is the Reducer is simple as well. It iterates through the values for each key, computes sum, maintains count and computes mean after the loop ends.</p>
<h3 id="mapper">Mapper</h3>
<pre><code>package com.iris.data.mapreduce;
import java.io.IOException;

import org.apache.hadoop.io.FloatWritable;
import org.apache.hadoop.io.LongWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Mapper;

public class IrisMapper extends Mapper&lt;LongWritable, Text, Text, FloatWritable&gt; {

    @Override
    public void map(LongWritable key, Text value, Context context)
            throws IOException, InterruptedException {

        String[] columns = value.toString().split(&quot;,&quot;);
        float sepal_len = Float.valueOf(columns[0]);
        String flower_class = columns[4];

        context.write(new Text(flower_class), new FloatWritable(sepal_len));
    }
}
</code></pre>
<h3 id="reducer">Reducer</h3>
<pre><code>package com.iris.data.mapreduce;
import java.io.IOException;

import org.apache.hadoop.io.FloatWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Reducer;

public class IrisReducer extends
        Reducer&lt;Text, FloatWritable, Text, FloatWritable&gt; {

    @Override
    public void reduce(Text key, Iterable&lt;FloatWritable&gt; values, Context context)
            throws IOException, InterruptedException {

        float sum = 0;
        float count = 0;
        float mean_sepal_len = 0;
        for (FloatWritable val : values) {
            sum += val.get();
            count++;
        }

        mean_sepal_len = sum / count;
        context.write(key, new FloatWritable(mean_sepal_len));
    }

}
</code></pre>
<h2 id="run-the-driver">Run the Driver</h2>
<p>You should see the following output</p>
<img src="/img/hadoop/iris_output.png" width="420"/>
<p><em>Header Image - &ldquo;<strong>Iris</strong>&rdquo; by Pauline Rosenberg via <a href="https://flic.kr/p/6sZzjm">Flickr</a>.</em></p>

  </div>

</article>

  


  
    <div class="nav-bkg-50 content-container-narrow-pad bottom-links text-0p75">
      <nav class="flex-row">
      
      <a href="https://robinsonraju.info/tech-notes/2015-09-21-simple-map-reduce-job/" class="flex-row v-center no-underline"  style="max-width:45%;">
        <span class="text-1p5">←</span>&nbsp;<span class="re-underline">Previous: Writing a simple Mapper and Reducer for Wordcount</span>
      </a>
      
      
        <a href="https://robinsonraju.info/tech-notes/2020-05-04-setting-up-hugo-site/" class="flex-row v-center no-underline" style="max-width: 45%;">
        <span class="re-underline">Next: Setting up Hugo Site and Migrating from Jekyll</span>&nbsp;<span class="text-1p5">→</span>
        </a>
      
      </nav>
    </div>
  

  </body>
</html>
