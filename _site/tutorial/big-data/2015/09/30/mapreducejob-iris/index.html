<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Welcome to my site. ">

    <title>A Simple MapReduce Job for Iris Dataset - Rob's Notes</title>

    <link rel="canonical" href="http://robinsonraju.github.io/tutorial/big-data/2015/09/30/mapreducejob-iris/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Rob's Notes</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="/">About</a></li>
                <li><a href="/books">Books</a></li>
                <li><a href="/tutorials">Tutorials</a></li>
                <li><a href="/papers">Papers</a></li>
                <li><a href="/blog">General</a></li>
                <li><a href="/quotes">Quotes</a></li>
                <!--
                <li>
                    <a href="/about/">rr</a>
                </li>
                
                <li>
                    <a href="/blog/">Blog Archive</a>
                </li>
                
                <li>
                    <a href="/books/">Books</a>
                </li>
                
                <li>
                    <a href="/">rr</a>
                </li>
                
                <li>
                    <a href="/papers/">Papers</a>
                </li>
                
                <li>
                    <a href="/quotes/"></a>
                </li>
                
                <li>
                    <a href="/tutorials/">Tutorials</a>
                </li>
                -->
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    
    <header class="intro-header" style="background-image: url('/img/hadoop/iris.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="site-heading">
                    <h1>A Simple MapReduce Job for Iris Dataset</h1>
                    <hr class="small">
                    <span class="subheading"></span>
                </div>
            </div>
        </div>
    </div>
</header>
    
    <!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<p>This blog is an attempt to walk through the process of using hadoop to analyze a dataset that might look similar to an actual dataset that we might encounter.</p>

<p>The objective is to read data from Iris dataset - <a href="https://archive.ics.uci.edu/ml/datasets/Iris">https://archive.ics.uci.edu/ml/datasets/Iris</a> and calculate the mean sepal length of each class of the flower.</p>

<p>The data is here -&gt; <a href="https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</a>.</p>

<p>Sample record : <code>5.1,3.5,1.4,0.2,Iris-setosa</code></p>

<p>Attribute Information:</p>

<ol>
  <li>sepal length in cm</li>
  <li>sepal width in cm</li>
  <li>petal length in cm</li>
  <li>petal width in cm</li>
  <li>class: a) Iris Setosa, b) Iris Versicolour, c) Iris Virginica</li>
</ol>

<p>In the last blog on wordcount, I used an eclipse project that was bundled automatically with the Cloudera VM and just modified the StubMapper, StubReducer and Driver to plugin the code for wordcount. In this, I thought I’ll create one from scratch and see how it works.</p>

<h2 id="step-1--create-a-java-project">Step #1 : Create a Java project</h2>
<p>Create a Java project using Eclipse. 
Add Mapper, Reducer and Driver stubs from the other project. You’ll immediately notice that there are many compilation errors.</p>

<h2 id="step-2-configure-build-path">Step 2: Configure Build Path</h2>
<p>Add the following libraries from <code>/usr/lib/hadoop/client</code> and <code>/cloudera/lib</code></p>

<p><code>Properties &gt; Java Build Path &gt; Add External Jars</code></p>

<p><img src="/img/hadoop/add_lib2.png" width="420" /></p>

<p><img src="/img/hadoop/add_lib1.png" width="420" /></p>

<p>Also add <code>&lt;project&gt;/conf</code> as the class folder.</p>

<p><img src="/img/hadoop/class_folder.png" width="420" /></p>

<p>Now the compilation issues would be resolved.</p>

<h2 id="step-3-add-code-for-mapper-and-reducer">Step 3: Add code for Mapper and Reducer</h2>

<p>The objective is to read the records from the data and compute the mean sepal length of each class of the Iris flower. 
map() function in the Mapper gets each row and splits the columns to extract out the key (flower class) and the value (sepal length). 
The reduce() function is the Reducer is simple as well. It iterates through the values for each key, computes sum, maintains count and computes mean after the loop ends.</p>

<h3 id="mapper">Mapper</h3>

<pre><code>package com.iris.data.mapreduce;
import java.io.IOException;

import org.apache.hadoop.io.FloatWritable;
import org.apache.hadoop.io.LongWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Mapper;

public class IrisMapper extends Mapper&lt;LongWritable, Text, Text, FloatWritable&gt; {

	@Override
	public void map(LongWritable key, Text value, Context context)
			throws IOException, InterruptedException {

		String[] columns = value.toString().split(",");
		float sepal_len = Float.valueOf(columns[0]);
		String flower_class = columns[4];
		
		context.write(new Text(flower_class), new FloatWritable(sepal_len));
	}
}
</code></pre>

<h3 id="reducer">Reducer</h3>
<pre><code>package com.iris.data.mapreduce;
import java.io.IOException;

import org.apache.hadoop.io.FloatWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Reducer;

public class IrisReducer extends
		Reducer&lt;Text, FloatWritable, Text, FloatWritable&gt; {

	@Override
	public void reduce(Text key, Iterable&lt;FloatWritable&gt; values, Context context)
			throws IOException, InterruptedException {

		float sum = 0;
		float count = 0;
		float mean_sepal_len = 0;
		for (FloatWritable val : values) {
			sum += val.get();
			count++;
		}
		
		mean_sepal_len = sum / count;
		context.write(key, new FloatWritable(mean_sepal_len));
	}

}
</code></pre>

<h2 id="run-the-driver">Run the Driver</h2>

<p>You should see the following output</p>

<p><img src="/img/hadoop/iris_output.png" width="420" /></p>

<p><em>Header Image - “<strong>Iris</strong>” by Pauline Rosenberg via <a href="https://flic.kr/p/6sZzjm">Flickr</a>.</em></p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/tutorial/big-data/2015/09/21/simple-map-reduce-job/" data-toggle="tooltip" data-placement="top" title="Writing a simple Mapper and Reducer for Wordcount">&larr; Previous Post</a>
                    </li>
                    
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/robinsonraju">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://www.facebook.com/robinson.raju.165">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/robinsonraju">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; Rob's Notes 2016</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
